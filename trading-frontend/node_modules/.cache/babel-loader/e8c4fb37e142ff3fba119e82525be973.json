{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\casan\\\\trading-app\\\\trading-frontend\\\\src\\\\components\\\\controllers\\\\pnl\\\\InvestmentChart.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { fetchDailyPnls } from \"../api/DailyPNLApi\";\nimport { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer } from \"recharts\";\nimport { formatCash } from \"../func/functions\";\nconst timeFrames = [\"1D\", \"1W\", \"1M\", \"3M\", \"YTD\", \"1Y\", \"ALL\"];\nlet groupedData = {\n  daily: [],\n  weekly: [],\n  monthly: [],\n  threeMonths: [],\n  oneYear: [],\n  all: []\n};\nconst InvestmentChart = () => {\n  const [selectedTimeFrame, setSelectedTimeFrame] = useState(\"ALL\");\n  const [chartData, setChartData] = useState([]);\n  const [investmentSummary, setInvestmentSummary] = useState(null);\n  const organizeData = dailyPnls => {\n    dailyPnls.sort((a, b) => new Date(a.entry_date) - new Date(b.entry_date));\n    return {\n      daily: dailyPnls.slice(-1),\n      weekly: dailyPnls.slice(-7),\n      monthly: dailyPnls.slice(-30),\n      threeMonths: dailyPnls.slice(-90),\n      oneYear: dailyPnls.slice(-365),\n      all: dailyPnls\n    };\n  };\n\n  // Memoize updateChart to avoid re-rendering\n  const updateChart = useCallback(timeFrame => {\n    const data = groupedData[timeFrame.toLowerCase()];\n    const formattedData = formatChartData(data);\n    setChartData(formattedData.chart);\n    setInvestmentSummary(formattedData.summary);\n  }, []);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const dailyPnls = await fetchDailyPnls();\n        groupedData = organizeData(dailyPnls);\n        updateChart(selectedTimeFrame);\n      } catch (error) {\n        console.error(\"Error fetching PnL data:\", error);\n      }\n    };\n    fetchData();\n  }, [updateChart, selectedTimeFrame]);\n  useEffect(() => {\n    updateChart(selectedTimeFrame);\n  }, [selectedTimeFrame, updateChart]);\n  const formatChartData = data => {\n    let cumulativeBalance = 0;\n    const chart = data.map(entry => {\n      cumulativeBalance += parseFloat(entry.balance);\n      return {\n        date: new Date(entry.entry_date).toLocaleDateString(),\n        balance: cumulativeBalance\n      };\n    });\n    const summary = {\n      balance: cumulativeBalance,\n      percentageChange: (cumulativeBalance - data[0].balance) / data[0].balance * 100\n    };\n    return {\n      chart,\n      summary\n    };\n  };\n  const determineLineColor = () => {\n    return investmentSummary && investmentSummary.percentageChange >= 0 ? \"#4caf50\" : \"#e74c3c\";\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"investment-chart-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"investment-summary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, \"Investing\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, formatCash((investmentSummary === null || investmentSummary === void 0 ? void 0 : investmentSummary.balance) || 0)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, investmentSummary ? `${investmentSummary.percentageChange.toFixed(2)}% All time` : \"Loading...\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"time-frame-selector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, timeFrames.map(frame => /*#__PURE__*/React.createElement(\"button\", {\n    key: frame,\n    onClick: () => setSelectedTimeFrame(frame),\n    className: selectedTimeFrame === frame ? \"active\" : \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, frame))), /*#__PURE__*/React.createElement(ResponsiveContainer, {\n    width: \"100%\",\n    height: 300,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(LineChart, {\n    data: chartData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(XAxis, {\n    dataKey: \"date\",\n    hide: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(YAxis, {\n    hide: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Tooltip, {\n    formatter: value => formatCash(value),\n    labelFormatter: label => `Date: ${label}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Line, {\n    type: \"monotone\",\n    dataKey: \"balance\",\n    stroke: determineLineColor(),\n    strokeWidth: 2,\n    dot: false,\n    animationDuration: 500,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 11\n    }\n  }))));\n};\nexport default InvestmentChart;","map":{"version":3,"names":["React","useState","useEffect","useCallback","fetchDailyPnls","LineChart","Line","XAxis","YAxis","Tooltip","ResponsiveContainer","formatCash","timeFrames","groupedData","daily","weekly","monthly","threeMonths","oneYear","all","InvestmentChart","selectedTimeFrame","setSelectedTimeFrame","chartData","setChartData","investmentSummary","setInvestmentSummary","organizeData","dailyPnls","sort","a","b","Date","entry_date","slice","updateChart","timeFrame","data","toLowerCase","formattedData","formatChartData","chart","summary","fetchData","error","console","cumulativeBalance","map","entry","parseFloat","balance","date","toLocaleDateString","percentageChange","determineLineColor","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","toFixed","frame","key","onClick","width","height","dataKey","hide","formatter","value","labelFormatter","label","type","stroke","strokeWidth","dot","animationDuration"],"sources":["C:/Users/casan/trading-app/trading-frontend/src/components/controllers/pnl/InvestmentChart.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { fetchDailyPnls } from \"../api/DailyPNLApi\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport { formatCash } from \"../func/functions\";\r\n\r\nconst timeFrames = [\"1D\", \"1W\", \"1M\", \"3M\", \"YTD\", \"1Y\", \"ALL\"];\r\n\r\nlet groupedData = {\r\n  daily: [],\r\n  weekly: [],\r\n  monthly: [],\r\n  threeMonths: [],\r\n  oneYear: [],\r\n  all: [],\r\n};\r\n\r\nconst InvestmentChart = () => {\r\n  const [selectedTimeFrame, setSelectedTimeFrame] = useState(\"ALL\");\r\n  const [chartData, setChartData] = useState([]);\r\n  const [investmentSummary, setInvestmentSummary] = useState(null);\r\n\r\n  const organizeData = (dailyPnls) => {\r\n    dailyPnls.sort((a, b) => new Date(a.entry_date) - new Date(b.entry_date));\r\n    return {\r\n      daily: dailyPnls.slice(-1),\r\n      weekly: dailyPnls.slice(-7),\r\n      monthly: dailyPnls.slice(-30),\r\n      threeMonths: dailyPnls.slice(-90),\r\n      oneYear: dailyPnls.slice(-365),\r\n      all: dailyPnls,\r\n    };\r\n  };\r\n\r\n  // Memoize updateChart to avoid re-rendering\r\n  const updateChart = useCallback((timeFrame) => {\r\n    const data = groupedData[timeFrame.toLowerCase()];\r\n    const formattedData = formatChartData(data);\r\n    setChartData(formattedData.chart);\r\n    setInvestmentSummary(formattedData.summary);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const dailyPnls = await fetchDailyPnls();\r\n        groupedData = organizeData(dailyPnls);\r\n        updateChart(selectedTimeFrame);\r\n      } catch (error) {\r\n        console.error(\"Error fetching PnL data:\", error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [updateChart, selectedTimeFrame]);\r\n\r\n  useEffect(() => {\r\n    updateChart(selectedTimeFrame);\r\n  }, [selectedTimeFrame, updateChart]);\r\n\r\n  const formatChartData = (data) => {\r\n    let cumulativeBalance = 0;\r\n    const chart = data.map((entry) => {\r\n      cumulativeBalance += parseFloat(entry.balance);\r\n      return {\r\n        date: new Date(entry.entry_date).toLocaleDateString(),\r\n        balance: cumulativeBalance,\r\n      };\r\n    });\r\n\r\n    const summary = {\r\n      balance: cumulativeBalance,\r\n      percentageChange:\r\n        ((cumulativeBalance - data[0].balance) / data[0].balance) * 100,\r\n    };\r\n\r\n    return { chart, summary };\r\n  };\r\n\r\n  const determineLineColor = () => {\r\n    return investmentSummary && investmentSummary.percentageChange >= 0\r\n      ? \"#4caf50\"\r\n      : \"#e74c3c\";\r\n  };\r\n\r\n  return (\r\n    <div className=\"investment-chart-container\">\r\n      <div className=\"investment-summary\">\r\n        <h2>Investing</h2>\r\n        <p>{formatCash(investmentSummary?.balance || 0)}</p>\r\n        <p>\r\n          {investmentSummary\r\n            ? `${investmentSummary.percentageChange.toFixed(2)}% All time`\r\n            : \"Loading...\"}\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"time-frame-selector\">\r\n        {timeFrames.map((frame) => (\r\n          <button\r\n            key={frame}\r\n            onClick={() => setSelectedTimeFrame(frame)}\r\n            className={selectedTimeFrame === frame ? \"active\" : \"\"}\r\n          >\r\n            {frame}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <LineChart data={chartData}>\r\n          <XAxis dataKey=\"date\" hide />\r\n          <YAxis hide />\r\n          <Tooltip\r\n            formatter={(value) => formatCash(value)}\r\n            labelFormatter={(label) => `Date: ${label}`}\r\n          />\r\n          <Line\r\n            type=\"monotone\"\r\n            dataKey=\"balance\"\r\n            stroke={determineLineColor()}\r\n            strokeWidth={2}\r\n            dot={false}\r\n            animationDuration={500}\r\n          />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvestmentChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}